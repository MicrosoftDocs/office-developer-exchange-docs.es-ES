---
title: Comunicarse con EWS mediante la API administrada de EWS
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.assetid: d1b78293-da02-413a-875c-681e99146af3
description: Obtenga información sobre cómo usar la API administrada de EWS para comunicarse con EWS en Exchange.
localization_priority: Priority
ms.openlocfilehash: be807f2d936bf79d181476ec8eb12f20fca7950f
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/03/2020
ms.locfileid: "44528247"
---
# <a name="communicate-with-ews-by-using-the-ews-managed-api"></a><span data-ttu-id="dc34d-103">Comunicarse con EWS mediante la API administrada de EWS</span><span class="sxs-lookup"><span data-stu-id="dc34d-103">Communicate with EWS by using the EWS Managed API</span></span>

<span data-ttu-id="dc34d-104">Obtenga información sobre cómo usar la API administrada de EWS para comunicarse con EWS en Exchange.</span><span class="sxs-lookup"><span data-stu-id="dc34d-104">Find information about how to use the EWS Managed API to communicate with EWS in Exchange.</span></span>
  
<span data-ttu-id="dc34d-105">La clase [ExchangeService](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservice%28v=exchg.80%29.aspx) de la API administrada de EWS contiene los métodos y las propiedades que se usan para establecer las credenciales de usuario, identificar el extremo de EWS, enviar y recibir mensajes SOAP y configurar el enlace para comunicarse con EWS.</span><span class="sxs-lookup"><span data-stu-id="dc34d-105">The [ExchangeService](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservice%28v=exchg.80%29.aspx) class in the EWS Managed API contains the methods and properties that you use to set user credentials, identify the EWS endpoint, send and receive SOAP messages, and configure the binding to communicate with EWS.</span></span> <span data-ttu-id="dc34d-106">Antes de poder usar la API administrada de EWS para realizar cualquier tarea, tiene que crear una instancia de la clase **ExchangeService** y enlazarla a EWS.</span><span class="sxs-lookup"><span data-stu-id="dc34d-106">Before you can use the EWS Managed API to perform any task, you have to create an instance of the **ExchangeService** class and bind it to EWS.</span></span> 
  
<span data-ttu-id="dc34d-107">Después de configurar un objeto [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) con credenciales de usuario y el punto de conexión de EWS, cualquier objeto de buzón de correo que haga referencia al objeto [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) puede usar los siguientes tipos de método para comunicarse con EWS:</span><span class="sxs-lookup"><span data-stu-id="dc34d-107">After you set up an [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) object with user credentials and the EWS endpoint, any mailbox object that references the [ExchangeService](https://msdn.microsoft.com/library/Microsoft.Exchange.WebServices.Data.ExchangeService.aspx) object can use the following method types to communicate with EWS:</span></span> 
  
- <span data-ttu-id="dc34d-108">Métodos del objeto ExchangeService: todos los métodos del objeto **ExchangeService** que no se heredan del tipo de **objeto** base realizan llamadas a EWS.</span><span class="sxs-lookup"><span data-stu-id="dc34d-108">ExchangeService object methods — All the methods on the **ExchangeService** object that are not inherited from the base **Object** type make calls to EWS.</span></span> 
    
- <span data-ttu-id="dc34d-109">Los métodos de tipo de carpeta y elemento de buzón de Exchange.</span><span class="sxs-lookup"><span data-stu-id="dc34d-109">Exchange mailbox item and folder type methods.</span></span>
    
<span data-ttu-id="dc34d-110">**Tabla 1. Métodos de tipo de carpeta y elemento de buzón de correo que se comunican con EWS**</span><span class="sxs-lookup"><span data-stu-id="dc34d-110">**Table 1. Mailbox item and folder type methods that communicate with EWS**</span></span>

|<span data-ttu-id="dc34d-111">Method</span><span class="sxs-lookup"><span data-stu-id="dc34d-111">Method</span></span>|<span data-ttu-id="dc34d-112">Lo que hace</span><span class="sxs-lookup"><span data-stu-id="dc34d-112">What it does</span></span>|<span data-ttu-id="dc34d-113">Operaciones a las que llama</span><span class="sxs-lookup"><span data-stu-id="dc34d-113">Operations that it calls</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="dc34d-114">Load</span><span class="sxs-lookup"><span data-stu-id="dc34d-114">Load</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.load%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dc34d-115">Obtiene las propiedades de un elemento, datos adjuntos o un objeto de configuración de usuario.</span><span class="sxs-lookup"><span data-stu-id="dc34d-115">Gets properties on an item, attachment, or user configuration object.</span></span>  <br/> |[<span data-ttu-id="dc34d-116">Operación GetItem</span><span class="sxs-lookup"><span data-stu-id="dc34d-116">GetItem operation</span></span>](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dc34d-117">Operación GetAttachment</span><span class="sxs-lookup"><span data-stu-id="dc34d-117">GetAttachment operation</span></span>](https://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dc34d-118">Operación GetUserConfiguration</span><span class="sxs-lookup"><span data-stu-id="dc34d-118">GetUserConfiguration operation</span></span>](https://msdn.microsoft.com/library/71d50e3c-92bd-435f-8118-b28bb85f8138%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dc34d-119">BIND</span><span class="sxs-lookup"><span data-stu-id="dc34d-119">Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dc34d-120">Rellena un nuevo elemento en el cliente con información de un elemento existente en el servidor.</span><span class="sxs-lookup"><span data-stu-id="dc34d-120">Populates a new item on the client with information from an existing item on the server.</span></span>  <br/> |[<span data-ttu-id="dc34d-121">Operación GetItem</span><span class="sxs-lookup"><span data-stu-id="dc34d-121">GetItem operation</span></span>](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dc34d-122">Save</span><span class="sxs-lookup"><span data-stu-id="dc34d-122">Save</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.save%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dc34d-123">Guarda la copia del elemento de cliente en el servidor.</span><span class="sxs-lookup"><span data-stu-id="dc34d-123">Saves the copy of the client item on the server.</span></span>  <br/> |[<span data-ttu-id="dc34d-124">Operación UpdateItem</span><span class="sxs-lookup"><span data-stu-id="dc34d-124">UpdateItem operation</span></span>](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dc34d-125">Operación UpdateFolder</span><span class="sxs-lookup"><span data-stu-id="dc34d-125">UpdateFolder operation</span></span>](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="dc34d-126">Operación CreateItem</span><span class="sxs-lookup"><span data-stu-id="dc34d-126">CreateItem operation</span></span>](https://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="dc34d-127">Operación CreateFolder</span><span class="sxs-lookup"><span data-stu-id="dc34d-127">CreateFolder operation</span></span>](https://msdn.microsoft.com/library/6f6c334c-b190-4e55-8f0a-38f2a018d1b3%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dc34d-128">Actualización</span><span class="sxs-lookup"><span data-stu-id="dc34d-128">Update</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dc34d-129">Actualiza el servidor con los cambios realizados en el cliente.</span><span class="sxs-lookup"><span data-stu-id="dc34d-129">Updates the server with the changes made on the client.</span></span><br/><br/><span data-ttu-id="dc34d-130">Para elementos y carpetas, el método **Update** usa la [operación UpdateItem](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) y la [operación UpdateFolder](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc34d-130">For items and folders, the **Update** method uses the [UpdateItem operation](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) and the [UpdateFolder operation](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx).</span></span>  <br/> |[<span data-ttu-id="dc34d-131">Operación UpdateItem</span><span class="sxs-lookup"><span data-stu-id="dc34d-131">UpdateItem operation</span></span>](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/><br/>[<span data-ttu-id="dc34d-132">Operación UpdateFolder</span><span class="sxs-lookup"><span data-stu-id="dc34d-132">UpdateFolder operation</span></span>](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dc34d-133">Eliminar</span><span class="sxs-lookup"><span data-stu-id="dc34d-133">Delete</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dc34d-134">Elimina un elemento en el servidor.</span><span class="sxs-lookup"><span data-stu-id="dc34d-134">Deletes an item on the server.</span></span><br/><br/><span data-ttu-id="dc34d-135">Para elementos y carpetas, el método **Delete** usa la y la [operación DeleteFolder](https://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc34d-135">For items and folders, the **Delete** method uses the and the [DeleteFolder operation](https://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx).</span></span>  <br/> |[<span data-ttu-id="dc34d-136">Operación DeleteItem</span><span class="sxs-lookup"><span data-stu-id="dc34d-136">DeleteItem operation</span></span>](https://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dc34d-137">Operación DeleteFolder</span><span class="sxs-lookup"><span data-stu-id="dc34d-137">DeleteFolder operation</span></span>](https://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dc34d-138">Copy</span><span class="sxs-lookup"><span data-stu-id="dc34d-138">Copy</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dc34d-139">Crea una copia del elemento o carpetas en el servidor.</span><span class="sxs-lookup"><span data-stu-id="dc34d-139">Creates a copy of the item or folders on the server.</span></span>  <br/> |[<span data-ttu-id="dc34d-140">Operación CopyItem</span><span class="sxs-lookup"><span data-stu-id="dc34d-140">CopyItem operation</span></span>](https://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dc34d-141">Operación CopyFolder</span><span class="sxs-lookup"><span data-stu-id="dc34d-141">CopyFolder operation</span></span>](https://msdn.microsoft.com/library/c7ea0d68-9793-4144-b378-d99536776db9%28Office.15%29.aspx) <br/> |
|[<span data-ttu-id="dc34d-142">Move</span><span class="sxs-lookup"><span data-stu-id="dc34d-142">Move</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.move%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="dc34d-143">Mueve elementos o carpetas en el servidor.</span><span class="sxs-lookup"><span data-stu-id="dc34d-143">Moves items or folders on the server.</span></span>  <br/> |[<span data-ttu-id="dc34d-144">Operación MoveItem</span><span class="sxs-lookup"><span data-stu-id="dc34d-144">MoveItem operation</span></span>](https://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx) <br/><br/> [<span data-ttu-id="dc34d-145">Operación MoveFolder</span><span class="sxs-lookup"><span data-stu-id="dc34d-145">MoveFolder operation</span></span>](https://msdn.microsoft.com/library/c7233966-6c87-4a14-8156-b1610760176d%28Office.15%29.aspx) <br/> |
   
## <a name="to-use-the-ews-managed-api-to-communicate-with-ews"></a><span data-ttu-id="dc34d-146">Para usar la API administrada de EWS para comunicarse con EWS</span><span class="sxs-lookup"><span data-stu-id="dc34d-146">To use the EWS Managed API to communicate with EWS</span></span>

1. <span data-ttu-id="dc34d-147">Cree una instancia de la clase **ExchangeService** .</span><span class="sxs-lookup"><span data-stu-id="dc34d-147">Instantiate the **ExchangeService** class.</span></span> 
    
   ```csharp
    ExchangeService service = new ExchangeService();
   ```

   > [!NOTE]
   > <span data-ttu-id="dc34d-148">Si se crea una instancia de **ExchangeService** con un constructor vacío, se creará una instancia enlazada a la versión más reciente conocida de Exchange.</span><span class="sxs-lookup"><span data-stu-id="dc34d-148">Instantiating **ExchangeService** with an empty constructor will create an instance that is bound to the latest known version of Exchange.</span></span> <span data-ttu-id="dc34d-149">Como alternativa, puede dirigirse a una versión específica de Exchange especificando version como parámetro.</span><span class="sxs-lookup"><span data-stu-id="dc34d-149">Alternatively, you can target a specific version of Exchange by specifying version as a parameter.</span></span> `ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2007_SP1);`
  
2. <span data-ttu-id="dc34d-150">Establezca las credenciales del usuario que envía solicitudes al servidor de Exchange.</span><span class="sxs-lookup"><span data-stu-id="dc34d-150">Set the credentials of the user who sends requests to the Exchange server.</span></span> <span data-ttu-id="dc34d-151">Si desea conectarse a EWS desde un equipo que ha iniciado sesión en el dominio, con las credenciales del usuario autenticado, establezca la propiedad **UseDefaultCredentials** del objeto **ExchangeService** en **true**.</span><span class="sxs-lookup"><span data-stu-id="dc34d-151">If you want to connect to EWS from a computer that is logged on to the domain, using the credentials of the authenticated user, set the **UseDefaultCredentials** property on the **ExchangeService** object to **true**.</span></span>
    
   ```cs
    // Connect by using the default credentials of the authenticated user.
    service.UseDefaultCredentials = true;
   ```

   <span data-ttu-id="dc34d-152">Si no desea conectarse con las credenciales de usuario predeterminadas, establezca la propiedad **Credentials** en el objeto **ExchangeService** para especificar explícitamente las credenciales de un usuario diferente.</span><span class="sxs-lookup"><span data-stu-id="dc34d-152">If you do not want to connect by using the default user credentials, set the **Credentials** property on the **ExchangeService** object to explicitly specify the credentials of a different user.</span></span> <span data-ttu-id="dc34d-153">Si usa Exchange online o Exchange online como parte de Office 365, usará la autenticación básica, con solo un nombre de usuario y una contraseña.</span><span class="sxs-lookup"><span data-stu-id="dc34d-153">If you are using Exchange Online or Exchange Online as part of Office 365, you'll use basic authentication, with just a user name and password.</span></span> <span data-ttu-id="dc34d-154">Se requiere un nombre de dominio para la autenticación NTLM.</span><span class="sxs-lookup"><span data-stu-id="dc34d-154">A domain name is required for NTLM authentication.</span></span> 
    
   ```cs
    // Connect by using the credentials of user1 at contoso.com.
    service.Credentials = new WebCredentials("user1@contoso.com", "password");
   ```

   <span data-ttu-id="dc34d-155">También puede especificar las credenciales del usuario con el nombre de dominio y la contraseña del usuario.</span><span class="sxs-lookup"><span data-stu-id="dc34d-155">You can also specify the credentials of the user by using the user's domain name and password.</span></span>
    
   ```cs
    // Connect by using the credentials of contoso/user1.
    service.Credentials = new WebCredentials("user1", "password", "contoso");
   ```

   > [!NOTE]
   > <span data-ttu-id="dc34d-156">Si la propiedad **UseDefaultCredentials** está establecida en **true**, se omite el valor de la propiedad **Credentials** .</span><span class="sxs-lookup"><span data-stu-id="dc34d-156">If the **UseDefaultCredentials** property is set to **true**, the value of the **Credentials** property is ignored.</span></span> 
  
3. <span data-ttu-id="dc34d-157">Establezca la dirección URL del extremo de EWS.</span><span class="sxs-lookup"><span data-stu-id="dc34d-157">Set the URL of the EWS endpoint.</span></span> <span data-ttu-id="dc34d-158">Esta dirección URL busca el archivo. asmx de Exchange en el servidor de acceso de cliente.</span><span class="sxs-lookup"><span data-stu-id="dc34d-158">This URL locates the exchange.asmx file on Client Access server.</span></span>
    
   ```cs
    // Use Autodiscover to set the URL endpoint.
    service.AutodiscoverUrl("user1@contoso.com");
   ```

   > [!NOTE]
   >  <span data-ttu-id="dc34d-159">Aunque se puede establecer explícitamente la propiedad **URL** de **ExchangeService** en un valor codificado, se recomienda usar el servicio de detección automática por los motivos siguientes: > detección automática determina el mejor punto de conexión para un usuario determinado (el extremo más cercano al servidor de buzones del usuario).</span><span class="sxs-lookup"><span data-stu-id="dc34d-159">Although you can explicitly set the **Url** property of the **ExchangeService** to a hardcoded value, we recommend that you use the Autodiscover service instead, for the following reasons: >  Autodiscover determines the best endpoint for a given user (the endpoint that is closest to the user's Mailbox server).</span></span> <span data-ttu-id="dc34d-160">> la dirección URL de EWS puede cambiar si se implementan nuevos servidores de acceso de cliente.</span><span class="sxs-lookup"><span data-stu-id="dc34d-160">>  The EWS URL might change if new Client Access servers are deployed.</span></span> <span data-ttu-id="dc34d-161">En este escenario, el uso de la [detección automática](autodiscover-for-exchange.md) significa que no es necesario realizar cambios en el código.</span><span class="sxs-lookup"><span data-stu-id="dc34d-161">In this scenario, using [Autodiscover](autodiscover-for-exchange.md) means no code changes are necessary.</span></span> <span data-ttu-id="dc34d-162">> debe establecer la dirección URL explícitamente o llamar a **AutodiscoverUrl**, pero no debe hacer ambas cosas.</span><span class="sxs-lookup"><span data-stu-id="dc34d-162">>  You should either set the URL explicitly or call **AutodiscoverUrl**, but you should not do both.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="dc34d-163">Vea también</span><span class="sxs-lookup"><span data-stu-id="dc34d-163">See also</span></span>

- [<span data-ttu-id="dc34d-164">Empezar a trabajar con aplicaciones de cliente de la API administrada de EWS</span><span class="sxs-lookup"><span data-stu-id="dc34d-164">Get started with EWS Managed API client applications</span></span>](get-started-with-ews-managed-api-client-applications.md) 
- [<span data-ttu-id="dc34d-165">Usar autodetección para buscar puntos de conexión</span><span class="sxs-lookup"><span data-stu-id="dc34d-165">Use Autodiscover to find connection points</span></span>](how-to-use-autodiscover-to-find-connection-points.md)   
- [<span data-ttu-id="dc34d-166">Desarrollo de clientes de servicios web de Exchange</span><span class="sxs-lookup"><span data-stu-id="dc34d-166">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    

