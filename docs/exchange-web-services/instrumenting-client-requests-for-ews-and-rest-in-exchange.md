---
title: Instrumentar solicitudes de cliente para EWS y REST en Exchange
manager: sethgros
ms.date: 4/13/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 330de503-498d-447e-b4a9-c20fc1699fd1
description: Obtenga información sobre los encabezados HTTP en las solicitudes y respuestas REST de EWS y que pueden ayudarle a supervisar y solucionar problemas de su aplicación Exchange.
ms.openlocfilehash: 3a8ce889ec7a6b9e70ec25a95ac248902f48ca6c
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/31/2020
ms.locfileid: "44456307"
---
# <a name="instrumenting-client-requests-for-ews-and-rest-in-exchange"></a><span data-ttu-id="e349d-103">Instrumentar solicitudes de cliente para EWS y REST en Exchange</span><span class="sxs-lookup"><span data-stu-id="e349d-103">Instrumenting client requests for EWS and REST in Exchange</span></span>

<span data-ttu-id="e349d-104">Obtenga información sobre los encabezados HTTP en las solicitudes y respuestas REST de EWS y que pueden ayudarle a supervisar y solucionar problemas de su aplicación Exchange.</span><span class="sxs-lookup"><span data-stu-id="e349d-104">Learn about the HTTP headers in EWS and REST requests and responses that can help you monitor and troubleshoot your Exchange application.</span></span>
  
<span data-ttu-id="e349d-105">¿Le ha sucedido alguna vez?</span><span class="sxs-lookup"><span data-stu-id="e349d-105">Has this ever happened to you?</span></span> <span data-ttu-id="e349d-106">Un usuario de la aplicación informa de un error inesperado.</span><span class="sxs-lookup"><span data-stu-id="e349d-106">A user of your application reports an unexpected error.</span></span> <span data-ttu-id="e349d-107">Desea investigar, pero no puede reproducirlo.</span><span class="sxs-lookup"><span data-stu-id="e349d-107">You want to investigate, but you can't reproduce it.</span></span> <span data-ttu-id="e349d-108">El error ha desaparecido para el usuario y quedará con muy pocos datos que requieren acción.</span><span class="sxs-lookup"><span data-stu-id="e349d-108">The error has disappeared for the user, and you're left with very little actionable data.</span></span> <span data-ttu-id="e349d-109">Frustrante, ¿no?</span><span class="sxs-lookup"><span data-stu-id="e349d-109">Frustrating, isn't it?</span></span> <span data-ttu-id="e349d-110">Veamos cómo puede prepararse de forma proactiva para este escenario y, afortunadamente, evitar la frustración en el futuro.</span><span class="sxs-lookup"><span data-stu-id="e349d-110">Let's look at how you can proactively prepare for this scenario and hopefully avoid frustration in the future.</span></span>
  
## <a name="add-instrumentation-to-requests"></a><span data-ttu-id="e349d-111">Agregar instrumentación a las solicitudes</span><span class="sxs-lookup"><span data-stu-id="e349d-111">Add instrumentation to requests</span></span>

<span data-ttu-id="e349d-112">Le recomendamos que agregue encabezados HTTP adicionales a sus solicitudes para facilitar la solución de problemas.</span><span class="sxs-lookup"><span data-stu-id="e349d-112">We recommend that you add additional HTTP headers to your requests to facilitate troubleshooting.</span></span> <span data-ttu-id="e349d-113">Debe mantener un registro de esta información en algún lugar (por ejemplo, en un archivo de registro) para poder recuperarla más adelante si es necesario.</span><span class="sxs-lookup"><span data-stu-id="e349d-113">You should keep a record of this information somewhere (for example, in a log file) so that you can retrieve it later if you need to.</span></span> <span data-ttu-id="e349d-114">Esto es útil al examinar el tráfico de red y también es útil si se pone en contacto con el soporte técnico de Microsoft para obtener ayuda.</span><span class="sxs-lookup"><span data-stu-id="e349d-114">This is helpful when examining network traffic, and is also helpful if you contact Microsoft support for assistance.</span></span>
  
<span data-ttu-id="e349d-115">**Tabla 1. Encabezados de solicitud para la solución de problemas**</span><span class="sxs-lookup"><span data-stu-id="e349d-115">**Table 1. Request headers for troubleshooting**</span></span>

|<span data-ttu-id="e349d-116">**Encabezado HTTP (EWS)**</span><span class="sxs-lookup"><span data-stu-id="e349d-116">**HTTP header (EWS)**</span></span>|<span data-ttu-id="e349d-117">**Equivalente de API administrada de EWS**</span><span class="sxs-lookup"><span data-stu-id="e349d-117">**EWS Managed API equivalent**</span></span>|<span data-ttu-id="e349d-118">**Notas**</span><span class="sxs-lookup"><span data-stu-id="e349d-118">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="e349d-119">Agente de usuario</span><span class="sxs-lookup"><span data-stu-id="e349d-119">User-Agent</span></span>  <br/> |[<span data-ttu-id="e349d-120">ExchangeService. UserAgent</span><span class="sxs-lookup"><span data-stu-id="e349d-120">ExchangeService.UserAgent</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservicebase.useragent%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="e349d-121">Establézcalo en un valor único que identifique la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="e349d-121">Set this to a unique value that identifies your client application.</span></span><br/><br/> <span data-ttu-id="e349d-122">Usar el mismo valor para todas las solicitudes que envía la aplicación permite que Microsoft Ayude a solucionar los errores de llamada, en caso de que se produzcan.</span><span class="sxs-lookup"><span data-stu-id="e349d-122">Using the same value for all requests that your application sends allows Microsoft to help troubleshoot call failures, should they arise.</span></span>  <br/> |
|<span data-ttu-id="e349d-123">identificador de solicitud de cliente</span><span class="sxs-lookup"><span data-stu-id="e349d-123">client-request-id</span></span>  <br/> |[<span data-ttu-id="e349d-124">ExchangeService. ClientRequestId</span><span class="sxs-lookup"><span data-stu-id="e349d-124">ExchangeService.ClientRequestId</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservicebase.clientrequestid%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="e349d-125">Establézcalo en un valor único diferente para cada solicitud que envíe la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e349d-125">Set this to a different unique value for every request your application sends.</span></span><br/><br/> <span data-ttu-id="e349d-126">Le recomendamos que use un GUID.</span><span class="sxs-lookup"><span data-stu-id="e349d-126">We recommend that you use a GUID.</span></span> <span data-ttu-id="e349d-127">Este identificador único está pensado para usarse para correlacionar actividades entre dos sistemas en el caso de que algo vaya mal.</span><span class="sxs-lookup"><span data-stu-id="e349d-127">This unique identifier is intended to be used to correlate activities between two systems in the event that something goes wrong.</span></span>  <br/> |
|<span data-ttu-id="e349d-128">Return-Client-request-ID</span><span class="sxs-lookup"><span data-stu-id="e349d-128">return-client-request-id</span></span>  <br/> |[<span data-ttu-id="e349d-129">ExchangeService. ReturnClientRequestId</span><span class="sxs-lookup"><span data-stu-id="e349d-129">ExchangeService.ReturnClientRequestId</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservicebase.returnclientrequestid%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="e349d-130">Establézcalo en **true** para indicar al servidor de Exchange que debe devolver el valor del identificador de solicitud de cliente en la respuesta correspondiente.</span><span class="sxs-lookup"><span data-stu-id="e349d-130">Set this to **true** to signal to the Exchange server that it should return the value of your client-request-id in the corresponding response.</span></span><br/><br/> <span data-ttu-id="e349d-131">Puede usar esto para correlacionar las solicitudes y respuestas en los seguimientos de red o los seguimientos de API administrada de EWS.</span><span class="sxs-lookup"><span data-stu-id="e349d-131">You can use this to correlate requests and responses in network traces or EWS Managed API traces.</span></span>  <br/> |
|<span data-ttu-id="e349d-132">X-ClientStatistics</span><span class="sxs-lookup"><span data-stu-id="e349d-132">X-ClientStatistics</span></span>  <br/> |[<span data-ttu-id="e349d-133">ExchangeService. SendClientLatencies</span><span class="sxs-lookup"><span data-stu-id="e349d-133">ExchangeService.SendClientLatencies</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservicebase.sendclientlatencies%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="e349d-134">Se usa para [informar de latencias de EWS](#bk_ReportLatency) a Microsoft si su aplicación tiene acceso a Exchange online o Exchange online como parte de Office 365.</span><span class="sxs-lookup"><span data-stu-id="e349d-134">Used to [report EWS latencies](#bk_ReportLatency) to Microsoft if your application is accessing Exchange Online or Exchange Online as part of Office 365.</span></span>  <br/> |
   
## <a name="log-information-from-responses"></a><span data-ttu-id="e349d-135">Registrar información de respuestas</span><span class="sxs-lookup"><span data-stu-id="e349d-135">Log information from responses</span></span>

<span data-ttu-id="e349d-136">Al igual que el cliente puede Agregar instrumental adicional a las solicitudes que envía, Exchange agrega instrumental adicional a las respuestas en forma de encabezados HTTP.</span><span class="sxs-lookup"><span data-stu-id="e349d-136">Just as your client can add additional instrumentation to the requests it sends, Exchange adds additional instrumentation to the responses in the form of HTTP headers.</span></span> <span data-ttu-id="e349d-137">El cliente debe capturar esta información para ir junto con la información de instrumentación de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="e349d-137">Your client should capture this information to go along with the request instrumentation information.</span></span>
  
> [!NOTE]
> <span data-ttu-id="e349d-138">Si usa la API administrada de EWS, no hay equivalente directo para los encabezados HTTP.</span><span class="sxs-lookup"><span data-stu-id="e349d-138">If you are using the EWS Managed API, there is no direct equivalent for the HTTP headers.</span></span> <span data-ttu-id="e349d-139">Sin embargo, se puede tener acceso a todos los encabezados de respuesta HTTP a través de la propiedad [ExchangeService. HttpResponseHeaders](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservicebase.httpresponseheaders%28v=exchg.80%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="e349d-139">However, all HTTP response headers can be accessed via the [ExchangeService.HttpResponseHeaders](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservicebase.httpresponseheaders%28v=exchg.80%29.aspx) property.</span></span> 
  
<span data-ttu-id="e349d-140">**Tabla 2. Encabezados de respuesta HTTP**</span><span class="sxs-lookup"><span data-stu-id="e349d-140">**Table 2. HTTP response headers**</span></span>

|<span data-ttu-id="e349d-141">**Encabezado HTTP**</span><span class="sxs-lookup"><span data-stu-id="e349d-141">**HTTP header**</span></span>|<span data-ttu-id="e349d-142">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="e349d-142">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e349d-143">identificador de solicitud</span><span class="sxs-lookup"><span data-stu-id="e349d-143">request-id</span></span>  <br/> |<span data-ttu-id="e349d-144">IDENTIFICADOR generado por el servidor para la solicitud que corresponde a esta respuesta.</span><span class="sxs-lookup"><span data-stu-id="e349d-144">A server-generated ID for the request that corresponds to this response.</span></span>  <br/> |
|<span data-ttu-id="e349d-145">identificador de solicitud de cliente</span><span class="sxs-lookup"><span data-stu-id="e349d-145">client-request-id</span></span>  <br/> |<span data-ttu-id="e349d-146">El valor del encabezado de identificador de solicitud de cliente en la solicitud.</span><span class="sxs-lookup"><span data-stu-id="e349d-146">The value of the client-request-id header in the request.</span></span><br/><br/> <span data-ttu-id="e349d-147">Este encabezado solo está presente si la solicitud contiene el encabezado Return-Client-request-ID con un valor **true**.</span><span class="sxs-lookup"><span data-stu-id="e349d-147">This header is only present if the request contains the return-client-request-id header with a value of **true**.</span></span>  <br/> |
|<span data-ttu-id="e349d-148">X-FEServer</span><span class="sxs-lookup"><span data-stu-id="e349d-148">X-FEServer</span></span>  <br/> |<span data-ttu-id="e349d-149">El FQDN del servidor de acceso de cliente que procesó la solicitud.</span><span class="sxs-lookup"><span data-stu-id="e349d-149">The FQDN of the Client Access server that processed the request.</span></span>  <br/> |
|<span data-ttu-id="e349d-150">X-TargetBEServer</span><span class="sxs-lookup"><span data-stu-id="e349d-150">X-TargetBEServer</span></span>  <br/> |<span data-ttu-id="e349d-151">El FQDN del servidor de buzones de correo que ha procesado la solicitud.</span><span class="sxs-lookup"><span data-stu-id="e349d-151">The FQDN of the mailbox server that processed the request.</span></span>  <br/> |
|<span data-ttu-id="e349d-152">X-DiagInfo</span><span class="sxs-lookup"><span data-stu-id="e349d-152">X-DiagInfo</span></span>  <br/> |<span data-ttu-id="e349d-153">Información de diagnóstico adicional, según la solicitud.</span><span class="sxs-lookup"><span data-stu-id="e349d-153">Additional diagnostic information, depending on the request.</span></span>  <br/> |
|<span data-ttu-id="e349d-154">x-MS-Diagnostics</span><span class="sxs-lookup"><span data-stu-id="e349d-154">x-ms-diagnostics</span></span>  <br/> | <span data-ttu-id="e349d-155">Este encabezado solo se aplica si se usa la autenticación OAuth en la solicitud.</span><span class="sxs-lookup"><span data-stu-id="e349d-155">This header is only applicable if OAuth authentication is used in the request.</span></span><br/><br/> <span data-ttu-id="e349d-156">Contiene un código de error explícito que especifica por qué se produjo un error en la autenticación OAuth.</span><span class="sxs-lookup"><span data-stu-id="e349d-156">It contains an explicit error code that specifies why an OAuth authentication failed.</span></span><br/><br/> <span data-ttu-id="e349d-157">Tiene el siguiente formato:`errorId;reason="reason"error_type="error type"`</span><span class="sxs-lookup"><span data-stu-id="e349d-157">It takes the following format: `errorId;reason="reason"error_type="error type"`</span></span><br/><br/> <span data-ttu-id="e349d-158">El campo **motivo** es una descripción legible del error por el usuario.</span><span class="sxs-lookup"><span data-stu-id="e349d-158">The **reason** field is a human-readable description of the error.</span></span><br/><br/> <span data-ttu-id="e349d-159">El campo **errorId** es un número entero y el campo \*\* \_ tipo de error\*\* es la representación en forma de cadena de ese entero, de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="e349d-159">The **errorId** field is an integer, and the **error\_type** field is the string representation of that integer, as follows:</span></span><ul><li><span data-ttu-id="e349d-160">2 millones: firma no válida \_</span><span class="sxs-lookup"><span data-stu-id="e349d-160">2000000: invalid\_signature</span></span></li><li><span data-ttu-id="e349d-161">2000001: token no válido \_</span><span class="sxs-lookup"><span data-stu-id="e349d-161">2000001: invalid\_token</span></span></li><li>  <span data-ttu-id="e349d-162">2000002: token \_ expirado</span><span class="sxs-lookup"><span data-stu-id="e349d-162">2000002: token\_expired</span></span></li><li><span data-ttu-id="e349d-163">2000003: recurso no válido \_</span><span class="sxs-lookup"><span data-stu-id="e349d-163">2000003: invalid\_resource</span></span></li><li><span data-ttu-id="e349d-164">2000004: inquilino no válido \_</span><span class="sxs-lookup"><span data-stu-id="e349d-164">2000004: invalid\_tenant</span></span>  </li><li><span data-ttu-id="e349d-165">2000005: usuario no válido \_</span><span class="sxs-lookup"><span data-stu-id="e349d-165">2000005: invalid\_user</span></span></li><li><span data-ttu-id="e349d-166">2000006: cliente no válido \_</span><span class="sxs-lookup"><span data-stu-id="e349d-166">2000006: invalid\_client</span></span></li><li><span data-ttu-id="e349d-167">2000007: \_ error interno</span><span class="sxs-lookup"><span data-stu-id="e349d-167">2000007: internal\_error</span></span></li><li><span data-ttu-id="e349d-168">2000008: concesión no válida \_</span><span class="sxs-lookup"><span data-stu-id="e349d-168">2000008: invalid\_grant</span></span></li></ul> |
   
## <a name="report-ews-latency-to-microsoft"></a><span data-ttu-id="e349d-169">Informar de latencia de EWS a Microsoft</span><span class="sxs-lookup"><span data-stu-id="e349d-169">Report EWS latency to Microsoft</span></span>
<span data-ttu-id="e349d-170"><a name="bk_ReportLatency"> </a></span><span class="sxs-lookup"><span data-stu-id="e349d-170"><a name="bk_ReportLatency"> </a></span></span>

<span data-ttu-id="e349d-171">Si la aplicación usa la API administrada de EWS o EWS para conectarse a Exchange Online, puede notificar la latencia en las solicitudes de EWS directamente a Microsoft.</span><span class="sxs-lookup"><span data-stu-id="e349d-171">If your application uses the EWS Managed API or EWS to connect to Exchange Online, you can report latency in EWS requests directly to Microsoft.</span></span> <span data-ttu-id="e349d-172">La información se pasa a través del encabezado de solicitud X-ClientStatistics.</span><span class="sxs-lookup"><span data-stu-id="e349d-172">The information is passed via the X-ClientStatistics request header.</span></span> <span data-ttu-id="e349d-173">Si usa la API administrada de EWS, todo lo que tiene que hacer es establecer la propiedad [ExchangeService. SendClientLatencies](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservicebase.sendclientlatencies%28v=exchg.80%29.aspx) en **true**.</span><span class="sxs-lookup"><span data-stu-id="e349d-173">If you are using the EWS Managed API, all you have to do is set the [ExchangeService.SendClientLatencies](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservicebase.sendclientlatencies%28v=exchg.80%29.aspx) property to **true**.</span></span> <span data-ttu-id="e349d-174">Si usa EWS, deberá medir el tiempo entre emitir una solicitud y recibir una respuesta y, a continuación, agregar el encabezado X-ClientStatistics a la siguiente solicitud de EWS que envíe la aplicación, con el siguiente formato.</span><span class="sxs-lookup"><span data-stu-id="e349d-174">If you are using EWS, you'll need to measure the time between issuing a request and receiving a response, then add the X-ClientStatistics header to the next EWS request your application sends, using the following format.</span></span>
  
`X-ClientStatistics: MessageId=<value of request-id header>,ResponseTime=<time in milliseconds>,SoapAction=<EWS operation>`
  
<span data-ttu-id="e349d-175">Mantenemos informes para estas latencias y los usamos para mejorar de forma continua los servicios EWS en Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="e349d-175">We maintain reports for these latencies and use them to continuously improve EWS services in Exchange Online.</span></span>
  
## <a name="next-steps"></a><span data-ttu-id="e349d-176">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="e349d-176">Next steps</span></span>
<span data-ttu-id="e349d-177"><a name="bk_ReportLatency"> </a></span><span class="sxs-lookup"><span data-stu-id="e349d-177"><a name="bk_ReportLatency"> </a></span></span>

<span data-ttu-id="e349d-178">Una vez que haya agregado la instrumentación del cliente a la aplicación, es mejor preparado si algo va mal.</span><span class="sxs-lookup"><span data-stu-id="e349d-178">After you've added client instrumentation to your application, you're better prepared if something goes wrong.</span></span> <span data-ttu-id="e349d-179">Si esto ocurre, puede usar los datos de instrumentación para [solucionar los problemas de la aplicación](tools-and-resources-for-troubleshooting-ews-applications-for-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="e349d-179">If that happens, you can use your instrumentation data to [troubleshoot your application](tools-and-resources-for-troubleshooting-ews-applications-for-exchange.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="e349d-180">Vea también</span><span class="sxs-lookup"><span data-stu-id="e349d-180">See also</span></span>

- [<span data-ttu-id="e349d-181">Introducción al diseño de EWS cliente de Exchange</span><span class="sxs-lookup"><span data-stu-id="e349d-181">EWS client design overview for Exchange</span></span>](ews-client-design-overview-for-exchange.md)
- [<span data-ttu-id="e349d-182">Seguimiento de las solicitudes y respuestas para solucionar problemas de aplicaciones de la API administrada de EWS</span><span class="sxs-lookup"><span data-stu-id="e349d-182">Trace requests and responses to troubleshoot EWS Managed API applications</span></span>](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md)
- [<span data-ttu-id="e349d-183">Herramientas y recursos para solucionar problemas de las aplicaciones de EWS para Exchange</span><span class="sxs-lookup"><span data-stu-id="e349d-183">Tools and resources for troubleshooting EWS applications for Exchange</span></span>](tools-and-resources-for-troubleshooting-ews-applications-for-exchange.md)
    

