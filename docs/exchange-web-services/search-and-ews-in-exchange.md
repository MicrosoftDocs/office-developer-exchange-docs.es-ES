---
title: Búsqueda y EWS en Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 9fa5b836-857e-401d-9450-51e7dbc69104
description: Averigüe cómo buscar elementos en Exchange mediante el uso de la API administrada de EWS o EWS.
ms.openlocfilehash: da24258ba94b842fa97fff92148620344c939f05
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/25/2018
ms.locfileid: "19763304"
---
# <a name="search-and-ews-in-exchange"></a><span data-ttu-id="5428f-103">Búsqueda y EWS en Exchange</span><span class="sxs-lookup"><span data-stu-id="5428f-103">Search and EWS in Exchange</span></span>

<span data-ttu-id="5428f-104">Averigüe cómo buscar elementos en Exchange mediante el uso de la API administrada de EWS o EWS.</span><span class="sxs-lookup"><span data-stu-id="5428f-104">Find out how to search for items in Exchange by using the EWS Managed API or EWS.</span></span>
  
<span data-ttu-id="5428f-105">¿Hace a esto les resulta familiar?</span><span class="sxs-lookup"><span data-stu-id="5428f-105">Does this sound familiar?</span></span> <span data-ttu-id="5428f-106">Por último comienza dicho proyecto que ha colocando para semanas y necesita información acerca del proyecto que su jefe le ha enviado en hace semanas de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="5428f-106">You're finally starting that project you've been putting off for weeks, and you need information about the project that your manager sent you in email weeks ago.</span></span> <span data-ttu-id="5428f-107">La Bandeja de entrada tiene cientos o quizá miles de mensajes en ella.</span><span class="sxs-lookup"><span data-stu-id="5428f-107">Your Inbox has hundreds or perhaps thousands of messages in it.</span></span> <span data-ttu-id="5428f-108">¿A qué te dedicas?</span><span class="sxs-lookup"><span data-stu-id="5428f-108">What do you do?</span></span> <span data-ttu-id="5428f-109">¿Se desplaza a través de su correo electrónico hasta que encuentre el examen cada asunto y el remitente?</span><span class="sxs-lookup"><span data-stu-id="5428f-109">Do you scroll through your email scanning each subject and sender until you find it?</span></span> <span data-ttu-id="5428f-110">O bien, ¿usa la característica de búsqueda en el cliente de correo electrónico favorito para centrarse rápidamente en lo que necesita?</span><span class="sxs-lookup"><span data-stu-id="5428f-110">Or do you use the search feature in your favorite email client to quickly zero in on what you need?</span></span>
  
<span data-ttu-id="5428f-111">Búsqueda es, posiblemente, una característica debe tener para cualquier cliente de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="5428f-111">Search is arguably a must-have feature for any email client.</span></span> <span data-ttu-id="5428f-112">Pero la búsqueda puede usarse para mucho más que sólo lo que permite a los usuarios buscar su buzón.</span><span class="sxs-lookup"><span data-stu-id="5428f-112">But search can be used for a lot more than just enabling users to search their mailbox.</span></span> <span data-ttu-id="5428f-113">¿La aplicación necesita procesar las citas que hay dentro de las ventanas de tiempo específico?</span><span class="sxs-lookup"><span data-stu-id="5428f-113">Does your app need to process appointments that fall within specific time windows?</span></span> <span data-ttu-id="5428f-114">Es posible que necesite un informe sobre todos los elementos de tarea con un estado específico o mover todos los contactos con un nombre de empresa específico a una carpeta diferente.</span><span class="sxs-lookup"><span data-stu-id="5428f-114">Maybe you need to report on all task items with a specific status, or move all contacts with a specific company name to a different folder.</span></span> <span data-ttu-id="5428f-115">Búsqueda puede ayudar con todos estos requisitos.</span><span class="sxs-lookup"><span data-stu-id="5428f-115">Search can help with all of these requirements.</span></span>
  
## <a name="search-basics"></a><span data-ttu-id="5428f-116">Conceptos básicos de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-116">Search basics</span></span>
<span data-ttu-id="5428f-117"><a name="bk_SearchBasics"> </a></span><span class="sxs-lookup"><span data-stu-id="5428f-117"></span></span>

<span data-ttu-id="5428f-118">La API administrada de EWS y EWS ofrecen dos métodos básicos para especificar una búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-118">The EWS Managed API and EWS offer two basic methods for specifying a search.</span></span> <span data-ttu-id="5428f-119">Puede usar un [filtro de búsqueda](how-to-use-search-filters-with-ews-in-exchange.md) o una [cadena de consulta](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="5428f-119">You can use a [search filter](how-to-use-search-filters-with-ews-in-exchange.md) or a [query string](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md).</span></span> <span data-ttu-id="5428f-120">El método que utilice depende de la intención detrás de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-120">The method you use depends on the intent behind your search.</span></span>
  
<span data-ttu-id="5428f-121">**La tabla 1. Escenarios de filtros de búsqueda y las consultas de búsqueda**</span><span class="sxs-lookup"><span data-stu-id="5428f-121">**Table 1. Scenarios for search filters and search queries**</span></span>

|<span data-ttu-id="5428f-122">**Si quiere...**</span><span class="sxs-lookup"><span data-stu-id="5428f-122">**If you want to…**</span></span>|<span data-ttu-id="5428f-123">**Use un...**</span><span class="sxs-lookup"><span data-stu-id="5428f-123">**Use a…**</span></span>|<span data-ttu-id="5428f-124">**Notas**</span><span class="sxs-lookup"><span data-stu-id="5428f-124">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="5428f-125">Limitar la búsqueda a una propiedad concreta o un conjunto de propiedades</span><span class="sxs-lookup"><span data-stu-id="5428f-125">Limit your search to a specific property or set of properties</span></span>  <br/> |<span data-ttu-id="5428f-126">Filtro de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-126">Search filter</span></span>  <br/> |<span data-ttu-id="5428f-127">Filtros de búsqueda proporcionan el mejor nivel de control sobre el que se buscan las propiedades.</span><span class="sxs-lookup"><span data-stu-id="5428f-127">Search filters provide the best level of control over which properties are searched.</span></span> <span data-ttu-id="5428f-128">Aunque las cadenas de consulta pueden dirigir un conjunto limitado de propiedades mediante el uso de sintaxis de consulta avanzada (AQS), los filtros de búsqueda pueden dirigir cualquier propiedad.</span><span class="sxs-lookup"><span data-stu-id="5428f-128">Although query strings can target a limited set of properties by using Advanced Query Syntax (AQS), search filters can target any property.</span></span>  <br/> |
|<span data-ttu-id="5428f-129">Crear búsquedas con varios criterios</span><span class="sxs-lookup"><span data-stu-id="5428f-129">Create searches with multiple criteria</span></span>  <br/> |<span data-ttu-id="5428f-130">Filtro de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-130">Search filter</span></span>  <br/> |<span data-ttu-id="5428f-131">Con los filtros de búsqueda, se pueden combinar varios criterios de búsqueda junto con la lógica de los operadores and u OR, lo que permite búsquedas como "asunto contiene notas de la reunión y remitente es igual a 'Sadie Daniels'".</span><span class="sxs-lookup"><span data-stu-id="5428f-131">With search filters, multiple search criteria can be joined together with logical ANDs or ORs, allowing for searches like "subject contains 'Meeting Notes' AND sender equals 'Sadie Daniels'".</span></span> <span data-ttu-id="5428f-132">Aunque las cadenas de consulta también pueden unirse a varios criterios de búsqueda, están limitadas al conjunto de propiedades compatibles con cadenas de consulta.</span><span class="sxs-lookup"><span data-stu-id="5428f-132">Although query strings can also join multiple search criteria, they are limited to the set of properties supported by query strings.</span></span>  <br/> |
|<span data-ttu-id="5428f-133">Propiedades personalizadas de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-133">Search custom properties</span></span>  <br/> |<span data-ttu-id="5428f-134">Filtro de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-134">Search filter</span></span>  <br/> |<span data-ttu-id="5428f-135">Filtros de búsqueda pueden dirigir las propiedades personalizadas.</span><span class="sxs-lookup"><span data-stu-id="5428f-135">Search filters can target custom properties.</span></span> <span data-ttu-id="5428f-136">Cadenas de consulta no realice búsquedas en las propiedades personalizadas.</span><span class="sxs-lookup"><span data-stu-id="5428f-136">Query strings do not search custom properties.</span></span>  <br/> |
|<span data-ttu-id="5428f-137">Realizar una búsqueda de mayúsculas y minúsculas de propiedades de cadena</span><span class="sxs-lookup"><span data-stu-id="5428f-137">Perform a case sensitive search of string properties</span></span>  <br/> |<span data-ttu-id="5428f-138">Filtro de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-138">Search filter</span></span>  <br/> |<span data-ttu-id="5428f-139">Las búsquedas de cadena de consulta no distinguen mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="5428f-139">Query string searches are not case sensitive.</span></span>  <br/> |
|<span data-ttu-id="5428f-140">Controlar el modo de contención al buscar propiedades de cadena</span><span class="sxs-lookup"><span data-stu-id="5428f-140">Control the containment mode when searching string properties</span></span>  <br/> |<span data-ttu-id="5428f-141">Filtro de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-141">Search filter</span></span>  <br/> |<span data-ttu-id="5428f-142">Búsquedas de cadenas de consulta siempre son búsquedas de subcadenas.</span><span class="sxs-lookup"><span data-stu-id="5428f-142">Query string searches are always substring searches.</span></span> <span data-ttu-id="5428f-143">Si necesita buscar prefijos específicos o requieren a coincidencias exactas, un filtro de búsqueda es la mejor opción.</span><span class="sxs-lookup"><span data-stu-id="5428f-143">If you need to search for specific prefixes, or require exact matches, a search filter is the best choice.</span></span>  <br/> |
|<span data-ttu-id="5428f-144">Búsqueda de carpetas</span><span class="sxs-lookup"><span data-stu-id="5428f-144">Search for folders</span></span>  <br/> |<span data-ttu-id="5428f-145">Filtro de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-145">Search filter</span></span>  <br/> |<span data-ttu-id="5428f-146">EWS no es compatible con la búsqueda de las carpetas con una cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="5428f-146">EWS does not support searching for folders with a query string.</span></span>  <br/> |
|<span data-ttu-id="5428f-147">Crear una carpeta de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-147">Create a search folder</span></span>  <br/> |<span data-ttu-id="5428f-148">Filtro de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-148">Search filter</span></span>  <br/> |<span data-ttu-id="5428f-149">EWS no es compatible con la creación de las carpetas de búsqueda con una cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="5428f-149">EWS does not support creating search folders with a query string.</span></span>  <br/> |
|<span data-ttu-id="5428f-150">Búsqueda en todos los usados con frecuencia a las propiedades</span><span class="sxs-lookup"><span data-stu-id="5428f-150">Search across all commonly used properties</span></span>  <br/> |<span data-ttu-id="5428f-151">Cadena de consulta</span><span class="sxs-lookup"><span data-stu-id="5428f-151">Query string</span></span>  <br/> |<span data-ttu-id="5428f-152">Cadenas de consulta que no contienen AQS va a buscar en todas las propiedades usadas con más frecuencia.</span><span class="sxs-lookup"><span data-stu-id="5428f-152">Query strings that do not contain AQS will search across all commonly used properties.</span></span> <span data-ttu-id="5428f-153">Por ejemplo, un valor de cadena de consulta de "Mack Chaves" devolverá todos los mensajes enviados por Mack Chaves, así como todos los mensajes que tienen "Mack Chaves" en el asunto o el cuerpo.</span><span class="sxs-lookup"><span data-stu-id="5428f-153">For example, a query string value of "Mack Chaves" will return all messages sent by Mack Chaves as well as any messages that have "Mack Chaves" in the body or subject.</span></span>  <br/> |
|<span data-ttu-id="5428f-154">Construir una búsqueda basada en la entrada de usuario sencilla</span><span class="sxs-lookup"><span data-stu-id="5428f-154">Construct a search based on simple user input</span></span>  <br/> |<span data-ttu-id="5428f-155">Cadena de consulta</span><span class="sxs-lookup"><span data-stu-id="5428f-155">Query string</span></span>  <br/> |<span data-ttu-id="5428f-156">Una cadena de consulta es una excelente opción para permitir que un usuario final para realizar una búsqueda rápida escribiendo en una cadena simple.</span><span class="sxs-lookup"><span data-stu-id="5428f-156">A query string is a great choice for allowing an end user to do a quick search by typing in a simple string.</span></span> <span data-ttu-id="5428f-157">Dado que una búsqueda de cadena de consulta incluye todas las propiedades usadas con más frecuencia, los resultados contendrá los elementos que contienen los términos de búsqueda del usuario.</span><span class="sxs-lookup"><span data-stu-id="5428f-157">Because a query string search includes all commonly used properties, the results will contain any items that contain the user's search terms.</span></span>  <br/> |
   
### <a name="using-a-search-filter"></a><span data-ttu-id="5428f-158">Uso de un filtro de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-158">Using a search filter</span></span>

<span data-ttu-id="5428f-159">Filtros de búsqueda proporcionan una amplia gama de opciones de búsqueda y el mayor grado de control sobre cómo se realiza la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-159">Search filters give you a wide range of search options and the greatest degree of control over how the search is performed.</span></span> <span data-ttu-id="5428f-160">Puede usar filtros de búsqueda para llevar a cabo básicos de igualdad y las búsquedas de comparación, pero también puede buscar en el contenido de las propiedades de cadena o hacer comparaciones de máscara de bits.</span><span class="sxs-lookup"><span data-stu-id="5428f-160">You can use search filters to perform basic equality and comparison searches, but you can also search within the contents of string properties or do bitmask comparisons.</span></span>
  
<span data-ttu-id="5428f-161">Por ejemplo, puede buscar el contenido del asunto de los elementos mediante el uso de la clase [SearchFilter.ContainsSubstring](http://msdn.microsoft.com/es-es/library/microsoft.exchange.webservices.data.searchfilter.containssubstring%28v=exchg.80%29.aspx) en la API administrada de EWS.</span><span class="sxs-lookup"><span data-stu-id="5428f-161">For example, you can search the contents of the subject of items by using the [SearchFilter.ContainsSubstring](http://msdn.microsoft.com/es-es/library/microsoft.exchange.webservices.data.searchfilter.containssubstring%28v=exchg.80%29.aspx) class in the EWS Managed API.</span></span> <span data-ttu-id="5428f-162">En este ejemplo, se crea un filtro de búsqueda para buscar al asunto de la subcadena "notas de la reunión," mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="5428f-162">In this example, a search filter is created to search the subject for the substring "meeting notes", ignoring case.</span></span> 
  
```cs
SearchFilter.ContainsSubstring subjectFilter = new SearchFilter.ContainsSubstring(ItemSchema.Subject,
    "meeting notes", ContainmentMode.Substring, ComparisonMode.IgnoreCase);
```

<span data-ttu-id="5428f-163">También puede buscar en las propiedades personalizadas.</span><span class="sxs-lookup"><span data-stu-id="5428f-163">You can also search against custom properties.</span></span> <span data-ttu-id="5428f-164">En este ejemplo, se busca en la propiedad personalizada **ItemIndex** para valores superiores a 3.</span><span class="sxs-lookup"><span data-stu-id="5428f-164">In this example, the custom property **ItemIndex** is searched for values greater than 3.</span></span> 
  
```cs
Guid MyAppGuid = new Guid("{AA3DF801-4FC7-401F-BBC1-7C93D6498C2E}");
ExtendedPropertyDefinition customPropDefinition =
    new ExtendedPropertyDefinition(MyAppGuid, "ItemIndex", MapiPropertyType.Integer); 
SearchFilter.IsGreaterThan customPropFilter =
    new SearchFilter.IsGreaterThan(customPropDefinition, 3);
```

<span data-ttu-id="5428f-165">También puede combinar varios filtros de búsqueda para crear búsquedas más complejas.</span><span class="sxs-lookup"><span data-stu-id="5428f-165">You can also combine multiple search filters to create more complex searches.</span></span> <span data-ttu-id="5428f-166">Por ejemplo, puede combinar los dos filtros anteriores con un AND lógico mediante el uso de la clase [SearchFilter.SearchFilterCollection](http://msdn.microsoft.com/es-es/library/microsoft.exchange.webservices.data.searchfilter.searchfiltercollection%28v=exchg.80%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="5428f-166">For example, you can combine the previous two filters with a logical AND by using the [SearchFilter.SearchFilterCollection](http://msdn.microsoft.com/es-es/library/microsoft.exchange.webservices.data.searchfilter.searchfiltercollection%28v=exchg.80%29.aspx) class.</span></span> 
  
```cs
SearchFilter.SearchFilterCollection compoundFilter =
    new SearchFilter.SearchFilterCollection(LogicalOperator.And, subjectFilter, customPropFilter);
```

### <a name="using-a-query-string"></a><span data-ttu-id="5428f-167">Uso de una cadena de consulta</span><span class="sxs-lookup"><span data-stu-id="5428f-167">Using a query string</span></span>

<span data-ttu-id="5428f-168">Las cadenas de consulta proporcionan un enfoque diferente para buscar.</span><span class="sxs-lookup"><span data-stu-id="5428f-168">Query strings provide a different approach to search.</span></span> <span data-ttu-id="5428f-169">Tener menos control sobre los campos que se buscan y cómo se realiza la búsqueda cuando se usa una búsqueda de cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="5428f-169">You have less control over the fields that are searched and how the search is performed when you use a query string search.</span></span> <span data-ttu-id="5428f-170">No que es mala!</span><span class="sxs-lookup"><span data-stu-id="5428f-170">Not that that's a bad thing!</span></span> <span data-ttu-id="5428f-171">En algunos casos, es posible que desee convertir una red más amplia, por así decirlo.</span><span class="sxs-lookup"><span data-stu-id="5428f-171">In some cases, you might want to cast a wider net, so to speak.</span></span>
  
<span data-ttu-id="5428f-172">Por ejemplo, puede buscar "notas de la reunión" mediante el método de la API administrada de EWS [ExchangeService.FindItems](http://msdn.microsoft.com/es-es/library/jj223808%28v=exchg.80%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="5428f-172">For example, you can search for "meeting notes" by using the [ExchangeService.FindItems](http://msdn.microsoft.com/es-es/library/jj223808%28v=exchg.80%29.aspx) EWS Managed API method.</span></span> 
  
```cs
FindItemsResults<Item> results = service.FindItems(folder, "meeting notes", view);
```

<span data-ttu-id="5428f-173">Si compara los resultados de esta búsqueda a los resultados del ejemplo búsqueda **SearchFilter.ContainsSubstring** anteriormente, esta búsqueda va a contener más resultados.</span><span class="sxs-lookup"><span data-stu-id="5428f-173">If you compare the results of this search to the results of the **SearchFilter.ContainsSubstring** search example earlier, this search will contain more results.</span></span> <span data-ttu-id="5428f-174">La búsqueda de filtro de búsqueda devolverá sólo los elementos que tienen "notas de la reunión" en el asunto, mientras que la búsqueda devolverá los elementos que tienen "notas de la reunión" en el asunto, el cuerpo y el resto de los campos.</span><span class="sxs-lookup"><span data-stu-id="5428f-174">The search filter search will return only items that have "meeting notes" in the subject, while this search will return items that have "meeting notes" in the subject, body, and other fields.</span></span> 
  
<span data-ttu-id="5428f-175">Vamos a echar un vistazo a cómo puede restringir la cadena de consulta para obtener más cerca de los resultados que se vea desde el filtro de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-175">Let's take a look at how you can refine the query string to get closer to the results you see from the search filter.</span></span> <span data-ttu-id="5428f-176">Uso de AQS, puede limitar la búsqueda al asunto.</span><span class="sxs-lookup"><span data-stu-id="5428f-176">Using AQS, you can limit your search to the subject.</span></span>
  
```cs
FindItemsResults<Item> results = service.FindItems(folder, "subject:meeting notes", view);
```

<span data-ttu-id="5428f-177">Esto es más cerca, pero los resultados son aún no es exactamente el mismo.</span><span class="sxs-lookup"><span data-stu-id="5428f-177">This is closer, but the results are still not quite the same.</span></span> <span data-ttu-id="5428f-178">Cuando se utiliza una cadena de consulta con varias palabras, obtendrá a las coincidencias de incluso si las palabras no están en el orden que especifique, o incluso aunque no estén adyacentes entre sí.</span><span class="sxs-lookup"><span data-stu-id="5428f-178">When you use a query string with multiple words, you will get matches even if the words are not in the order you specify, or even if they're not adjacent to each other.</span></span> <span data-ttu-id="5428f-179">Con la cadena de consulta "notas de la reunión: asunto", va a obtener a coincidencias para "notas de la reunión", "notas de la reunión" y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="5428f-179">With the query string "subject:meeting notes", you will get matches for "meeting notes", "notes from the meeting", and so on.</span></span> <span data-ttu-id="5428f-180">Para depurar aún más, puede ajustar los términos de búsqueda en comillas dobles para indicar que desea que sólo esa frase.</span><span class="sxs-lookup"><span data-stu-id="5428f-180">To further refine, you can wrap the search terms in double quotes to indicate that you want that phrase only.</span></span>
  
```cs
FindItemsResults<Item> results = service.FindItems(folder, "subject:\"meeting notes\"", view);
```

## <a name="requesting-specific-properties-in-search-results"></a><span data-ttu-id="5428f-181">Solicitar propiedades específicas en los resultados de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-181">Requesting specific properties in search results</span></span>
<span data-ttu-id="5428f-182"><a name="bk_RequestSpecific"> </a></span><span class="sxs-lookup"><span data-stu-id="5428f-182"></span></span>

<span data-ttu-id="5428f-183">De forma predeterminada, los resultados de búsqueda va a contener todas las propiedades en los elementos que coinciden con la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-183">By default, search results will contain all properties on the items that match the search.</span></span> <span data-ttu-id="5428f-184">En algunos casos, esto podría ser lo que desea, pero en la mayoría de los casos, la aplicación sólo requiere un conjunto discreto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="5428f-184">In some cases this might be what you want, but in most cases your application only requires a discrete set of properties.</span></span> <span data-ttu-id="5428f-185">En este caso, debería limitar el conjunto de propiedades que se devuelven a las propiedades de la aplicación necesita.</span><span class="sxs-lookup"><span data-stu-id="5428f-185">In this case, you should limit the set of properties that are returned to only the properties your application needs.</span></span> <span data-ttu-id="5428f-186">En el siguiente ejemplo, se usa la clase [artículoVer](http://msdn.microsoft.com/es-es/library/microsoft.exchange.webservices.data.itemview%28v=exchg.80%29.aspx) para limitar las propiedades devueltas al asunto, fecha y hora de recepción y el identificador de los elementos.</span><span class="sxs-lookup"><span data-stu-id="5428f-186">In the following example, the [ItemView](http://msdn.microsoft.com/es-es/library/microsoft.exchange.webservices.data.itemview%28v=exchg.80%29.aspx) class is used to limit the returned properties to the subject, date/time received, and ID of the items.</span></span> 
  
```cs
ItemView view = new ItemView(10);
// Creating a new PropertySet with this constructor includes 
// ItemSchema.Id.
view.PropertySet = new PropertySet(ItemSchema.Subject, ItemSchema.DateTimeReceived);
```

## <a name="controlling-search-depth"></a><span data-ttu-id="5428f-187">Controlar la profundidad de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-187">Controlling search depth</span></span>
<span data-ttu-id="5428f-188"><a name="bk_SearchDepth"> </a></span><span class="sxs-lookup"><span data-stu-id="5428f-188"></span></span>

<span data-ttu-id="5428f-189">Establecer el recorrido en la vista controla la profundidad y el ámbito de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-189">Setting the traversal on the view controls the depth and scope of the search.</span></span> 
  
<span data-ttu-id="5428f-190">**Tabla 2. Búsqueda cruce seguro de los valores**</span><span class="sxs-lookup"><span data-stu-id="5428f-190">**Table 2. Search traversal values**</span></span>

|<span data-ttu-id="5428f-191">**Valor recorrido**</span><span class="sxs-lookup"><span data-stu-id="5428f-191">**Traversal value**</span></span>|<span data-ttu-id="5428f-192">**Se aplica a**</span><span class="sxs-lookup"><span data-stu-id="5428f-192">**Applies to**</span></span>|<span data-ttu-id="5428f-193">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="5428f-193">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="5428f-194">Superficial</span><span class="sxs-lookup"><span data-stu-id="5428f-194">Shallow</span></span>  <br/> |<span data-ttu-id="5428f-195">Los elementos y carpetas</span><span class="sxs-lookup"><span data-stu-id="5428f-195">Items and Folders</span></span>  <br/> |<span data-ttu-id="5428f-196">Realizar búsquedas superficiales están limitadas a elementos secundarios directos de la carpeta que se está buscando.</span><span class="sxs-lookup"><span data-stu-id="5428f-196">Shallow searches are limited to direct children of the folder being searched.</span></span>  <br/> |
|<span data-ttu-id="5428f-197">Profunda</span><span class="sxs-lookup"><span data-stu-id="5428f-197">Deep</span></span>  <br/> |<span data-ttu-id="5428f-198">Elementos (sólo con las carpetas de búsqueda) y carpetas</span><span class="sxs-lookup"><span data-stu-id="5428f-198">Items (only with search folders) and Folders</span></span>  <br/> |<span data-ttu-id="5428f-199">Búsquedas en profundidad recursivamente buscar la carpeta que se buscan y subcarpetas.</span><span class="sxs-lookup"><span data-stu-id="5428f-199">Deep searches recursively search the folder being searched and subfolders.</span></span>  <br/> |
|<span data-ttu-id="5428f-200">Asociado</span><span class="sxs-lookup"><span data-stu-id="5428f-200">Associated</span></span>  <br/> |<span data-ttu-id="5428f-201">Elementos</span><span class="sxs-lookup"><span data-stu-id="5428f-201">Items</span></span>  <br/> |<span data-ttu-id="5428f-202">Búsquedas asociadas sólo incluyen elementos asociados de la carpeta que se está buscando.</span><span class="sxs-lookup"><span data-stu-id="5428f-202">Associated searches only include associated items from the folder being searched.</span></span> <span data-ttu-id="5428f-203">Elementos asociados son elementos ocultos dentro de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="5428f-203">Associated items are hidden items within the folder.</span></span>  <br/> |
|<span data-ttu-id="5428f-204">SoftDeleted</span><span class="sxs-lookup"><span data-stu-id="5428f-204">SoftDeleted</span></span>  <br/> |<span data-ttu-id="5428f-205">Los elementos y carpetas</span><span class="sxs-lookup"><span data-stu-id="5428f-205">Items and Folders</span></span>  <br/> |<span data-ttu-id="5428f-206">Este tipo de cruce seguro de los está en desuso.</span><span class="sxs-lookup"><span data-stu-id="5428f-206">This traversal type is deprecated.</span></span> <span data-ttu-id="5428f-207">Las búsquedas de SoftDeleted incluyan solo los elementos que se encuentran en el volcado de archivos.</span><span class="sxs-lookup"><span data-stu-id="5428f-207">SoftDeleted searches only include items that are in the dumpster.</span></span> <span data-ttu-id="5428f-208">El volcado de archivos ha sido reemplazada por la [carpeta elementos recuperables](http://technet.microsoft.com/es-es/library/ee364755%28v=exchg.150%29.aspx(Office.15).aspx) en Exchange Online, Exchange Online como parte de Office 365 y las versiones de Exchange a partir de Exchange 2010.</span><span class="sxs-lookup"><span data-stu-id="5428f-208">The dumpster has been replaced by the [Recoverable Items Folder](http://technet.microsoft.com/es-es/library/ee364755%28v=exchg.150%29.aspx(Office.15).aspx) in Exchange Online, Exchange Online as part of Office 365, and versions of Exchange starting with Exchange 2010.</span></span>  <br/> |
   
## <a name="managing-search-results"></a><span data-ttu-id="5428f-209">Administración de los resultados de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-209">Managing search results</span></span>
<span data-ttu-id="5428f-210"><a name="bk_ManageSearchResults"> </a></span><span class="sxs-lookup"><span data-stu-id="5428f-210"></span></span>

<span data-ttu-id="5428f-211">La API administrada de EWS y EWS también permiten cambiar cómo se devuelven los resultados de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-211">The EWS Managed API and EWS also allow you to change how your search results are returned.</span></span> <span data-ttu-id="5428f-212">Puede usar vistas para especificar qué propiedades se incluyen en los resultados, ordenar los resultados y los resultados para sólo obtener un número de conjunto de resultados por respuesta de página.</span><span class="sxs-lookup"><span data-stu-id="5428f-212">You can use views to specify which properties are included in the results, sort results, and page your results to only get back a set number of results per response.</span></span> <span data-ttu-id="5428f-213">También puede agrupar los resultados por los valores de campo específico y control de la profundidad de una búsqueda mediante la especificación de un tipo de recorrido.</span><span class="sxs-lookup"><span data-stu-id="5428f-213">You can also group results by specific field values and control the depth of a search by specifying a traversal type.</span></span> <span data-ttu-id="5428f-214">Por último, puede usar las carpetas de búsqueda para crear búsquedas persistentes que se actualizan dinámicamente a medida que llegan nuevos elementos.</span><span class="sxs-lookup"><span data-stu-id="5428f-214">Finally, you can use search folders to create persistent searches that are updated dynamically as new items arrive.</span></span>
  
### <a name="sorting"></a><span data-ttu-id="5428f-215">Ordenación</span><span class="sxs-lookup"><span data-stu-id="5428f-215">Sorting</span></span>

<span data-ttu-id="5428f-216">Puede obtener el servidor para devolver resultados ordenados, lo que pueden hacer es más fácil mostrar o procesar los elementos de orden.</span><span class="sxs-lookup"><span data-stu-id="5428f-216">You can get the server to return sorted results, which can make it easier to display or process items in order.</span></span> <span data-ttu-id="5428f-217">En este ejemplo, los resultados se ordenarán por la fecha y hora recibida, con los elementos más recientes que se va a primera.</span><span class="sxs-lookup"><span data-stu-id="5428f-217">In this example, the results will be sorted by the date/time received, with the newest items being first.</span></span>
  
```cs
view.OrderBy.Add(ItemSchema.DateTimeReceived, SortDirection.Descending);
```

### <a name="paging"></a><span data-ttu-id="5428f-218">Paging</span><span class="sxs-lookup"><span data-stu-id="5428f-218">Paging</span></span>

<span data-ttu-id="5428f-219">Cuando envíe una solicitud de búsqueda mediante el uso de la API administrada de EWS o EWS, especifique un tamaño de vista, que controla el número máximo de elementos devueltos.</span><span class="sxs-lookup"><span data-stu-id="5428f-219">When you send a search request by using the EWS Managed API or EWS, you specify a view size, which controls the maximum number of items returned.</span></span> <span data-ttu-id="5428f-220">Sin embargo, el número de elementos en el servidor que coinciden con la búsqueda puede ser mayor que el tamaño de la vista.</span><span class="sxs-lookup"><span data-stu-id="5428f-220">However, the number of items on the server that match your search might be larger than the view size.</span></span> <span data-ttu-id="5428f-221">En este caso, el servidor indica que hay disponibles más elementos.</span><span class="sxs-lookup"><span data-stu-id="5428f-221">In this case, the server indicates that more items are available.</span></span> <span data-ttu-id="5428f-222">Puede [utilizar la paginación para repetir la búsqueda](how-to-perform-paged-searches-by-using-ews-in-exchange.md) y obtener el siguiente conjunto de resultados.</span><span class="sxs-lookup"><span data-stu-id="5428f-222">You can [use paging to repeat your search](how-to-perform-paged-searches-by-using-ews-in-exchange.md) and get the next set of results.</span></span> 
  
<span data-ttu-id="5428f-223">Por ejemplo, puede enviar una solicitud de búsqueda con un tamaño de vista de 10.</span><span class="sxs-lookup"><span data-stu-id="5428f-223">For example, you can send a search request with a view size of 10.</span></span> <span data-ttu-id="5428f-224">Puede haber 15 elementos en el servidor que coinciden con la búsqueda, pero sólo obtendrá los primeros 10, junto con un indicador (la [FindItemsResults\<TItem\>. MoreAvailable](http://msdn.microsoft.com/es-es/library/dd635477%28v=exchg.80%29.aspx) (propiedad) si se usa la API administrada de EWS) que no hay más resultados en el servidor.</span><span class="sxs-lookup"><span data-stu-id="5428f-224">There might be 15 items on the server that match your search, but you will only get back the first 10, along with an indicator (the [FindItemsResults\<TItem\>.MoreAvailable](http://msdn.microsoft.com/es-es/library/dd635477%28v=exchg.80%29.aspx) property if you're using the EWS Managed API) that there are more results on the server.</span></span> <span data-ttu-id="5428f-225">A continuación, puede enviar la misma búsqueda con un desplazamiento de 10 para solicitar la siguiente 10 elementos que coinciden con la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-225">You can then send the same search with an offset of 10 to ask for the next 10 items that match your search.</span></span> <span data-ttu-id="5428f-226">El servidor devolverá los elementos de cinco restantes.</span><span class="sxs-lookup"><span data-stu-id="5428f-226">The server will return the remaining five items.</span></span> 
  
<span data-ttu-id="5428f-227">**En la figura 1. Ejemplo de búsqueda paginada**</span><span class="sxs-lookup"><span data-stu-id="5428f-227">**Figure 1. Paged search example**</span></span>

![Ilustración que muestra una búsqueda paginada. Se envía una solicitud inicial de 10 elementos. Se envía una segunda solicitud de los 10 elementos siguientes.](media/Ex15_Search_PagedSearch.png)
  
### <a name="grouping"></a><span data-ttu-id="5428f-231">Agrupación</span><span class="sxs-lookup"><span data-stu-id="5428f-231">Grouping</span></span>

 <span data-ttu-id="5428f-232">Exchange permite a los resultados de búsqueda de grupo por un campo específico.</span><span class="sxs-lookup"><span data-stu-id="5428f-232">Exchange enables you to group search results by a specific field.</span></span> <span data-ttu-id="5428f-233">Esto puede ayudar a dividir los resultados de búsqueda en conjuntos más fácil de administrar.</span><span class="sxs-lookup"><span data-stu-id="5428f-233">This can help break up search results into more manageable sets.</span></span> <span data-ttu-id="5428f-234">Por ejemplo, puede buscar "notas de la reunión" y agrupar los resultados por remitente.</span><span class="sxs-lookup"><span data-stu-id="5428f-234">For example, you can search for "meeting notes" and group the results by sender.</span></span> <span data-ttu-id="5428f-235">Como se muestra en la siguiente ilustración, los elementos devueltos se dividirá en grupos, con todos los elementos que coinciden con los criterios del mismo remitente en uno de grupo, todos los elementos coincidentes de otro remitente en otro grupo y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="5428f-235">As shown in the following figure, the items returned will be separated into groups, with all the items that match the criteria from the same sender in one group, all the matching items from another sender in another group, and so on.</span></span> 
  
<span data-ttu-id="5428f-236">**La figura 2. Resultados de la búsqueda agrupados por remitente**</span><span class="sxs-lookup"><span data-stu-id="5428f-236">**Figure 2. Search results grouped by sender**</span></span>

![Ilustración que muestra los resultados de búsqueda agrupados por remitente.](media/Ex15_Search_GroupedResults.png)
  
## <a name="search-folders"></a><span data-ttu-id="5428f-238">Carpetas de búsqueda</span><span class="sxs-lookup"><span data-stu-id="5428f-238">Search folders</span></span>
<span data-ttu-id="5428f-239"><a name="bk_SearchFolders"> </a></span><span class="sxs-lookup"><span data-stu-id="5428f-239"></span></span>

<span data-ttu-id="5428f-240">Con una búsqueda normal, se ejecuta la búsqueda, los resultados se devuelven a la aplicación para el procesamiento y la búsqueda deja de existir.</span><span class="sxs-lookup"><span data-stu-id="5428f-240">With a regular search, the search is executed, the results are returned to your application for processing, and the search ceases to exist.</span></span> <span data-ttu-id="5428f-241">Las carpetas de búsqueda proporcionan una forma de realizar una búsqueda persistente.</span><span class="sxs-lookup"><span data-stu-id="5428f-241">Search folders provide a way to make a search persistent.</span></span> <span data-ttu-id="5428f-242">Ésta es una buena opción para las búsquedas que sabe que desea ejecutar varias veces.</span><span class="sxs-lookup"><span data-stu-id="5428f-242">This is a great option for searches that you know you will want to execute multiple times.</span></span> <span data-ttu-id="5428f-243">En lugar de ejecutar la misma búsqueda repetidas veces, lo que provoca que el servidor evaluar la búsqueda desde el principio cada vez, una carpeta de búsqueda realiza una búsqueda siempre en, lo que permite el servidor actualizar el resultado existente establecer como elementos se agregan a o eliminado del ámbito de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-243">Rather than executing the same search repeatedly, causing the server to evaluate the search from scratch each time, a search folder makes a search always on, allowing the server to update the existing result set as items are added to or removed from the search scope.</span></span> <span data-ttu-id="5428f-244">Acto de carpetas de búsqueda, como las carpetas normales, en que aparecen como las carpetas que contienen elementos.</span><span class="sxs-lookup"><span data-stu-id="5428f-244">Search folders act like regular folders, in that they appear as folders that have items in them.</span></span> <span data-ttu-id="5428f-245">La diferencia es que los únicos elementos incluidos en la carpeta son aquellos que coincidan con los criterios de búsqueda que están asociados con la carpeta.</span><span class="sxs-lookup"><span data-stu-id="5428f-245">The difference is that the only items contained in the folder are those that match the search criteria that are associated with the folder.</span></span> <span data-ttu-id="5428f-246">Una vez creada una carpeta de búsqueda, la aplicación puede obtener resultados actualizados de la búsqueda comprobando el contenido de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="5428f-246">After a search folder is created, your application can get up-to-date results of the search just by checking the contents of the folder.</span></span>
  
<span data-ttu-id="5428f-247">Creación de una carpeta de búsqueda es sencillo cuando ha aprendido a crear filtros de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5428f-247">Creating a search folder is simple when you've mastered creating search filters.</span></span> <span data-ttu-id="5428f-248">En el siguiente ejemplo, se crea una carpeta de búsqueda para mostrar todo el correo electrónico con un asunto que contiene "notas de la reunión".</span><span class="sxs-lookup"><span data-stu-id="5428f-248">In the following example, a search folder is created to show all email with a subject that contains "meeting notes".</span></span>
  
```cs
static void CreateSearchFolder(ExchangeService service)
{
    SearchFilter.ContainsSubstring subjectFilter = new SearchFilter.ContainsSubstring(ItemSchema.Subject,
        "meeting notes", ContainmentMode.Substring, ComparisonMode.IgnoreCase);
    SearchFolder searchFolder = new SearchFolder(service);
    searchFolder.DisplayName = "Meeting Notes";
    searchFolder.SearchParameters.RootFolderIds.Add(WellKnownFolderName.Inbox);
    searchFolder.SearchParameters.Traversal = SearchFolderTraversal.Deep;
    searchFolder.SearchParameters.SearchFilter = subjectFilter;
    searchFolder.Save(WellKnownFolderName.SearchFolders);
}
```

## <a name="in-this-section"></a><span data-ttu-id="5428f-249">En esta sección</span><span class="sxs-lookup"><span data-stu-id="5428f-249">In this section</span></span>
<span data-ttu-id="5428f-250"><a name="bk_InThisSection"> </a></span><span class="sxs-lookup"><span data-stu-id="5428f-250"></span></span>

- [<span data-ttu-id="5428f-251">Use los filtros de búsqueda con EWS en Exchange</span><span class="sxs-lookup"><span data-stu-id="5428f-251">Use search filters with EWS in Exchange</span></span>](how-to-use-search-filters-with-ews-in-exchange.md)
    
- [<span data-ttu-id="5428f-252">Realizar una búsqueda AQS mediante EWS en Exchange</span><span class="sxs-lookup"><span data-stu-id="5428f-252">Perform an AQS search by using EWS in Exchange</span></span>](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="5428f-253">Realizar búsquedas paginadas mediante EWS en Exchange</span><span class="sxs-lookup"><span data-stu-id="5428f-253">Perform paged searches by using EWS in Exchange</span></span>](how-to-perform-paged-searches-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="5428f-254">Realizar búsquedas agrupadas mediante EWS en Exchange</span><span class="sxs-lookup"><span data-stu-id="5428f-254">Perform grouped searches by using EWS in Exchange</span></span>](how-to-perform-grouped-searches-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="5428f-255">Trabajar con las carpetas de búsqueda con EWS en Exchange</span><span class="sxs-lookup"><span data-stu-id="5428f-255">Work with search folders by using EWS in Exchange</span></span>](how-to-work-with-search-folders-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="5428f-256">Vea también</span><span class="sxs-lookup"><span data-stu-id="5428f-256">See also</span></span>


- [<span data-ttu-id="5428f-257">Desarrollo de clientes de servicios web de Exchange</span><span class="sxs-lookup"><span data-stu-id="5428f-257">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- <span data-ttu-id="5428f-258">[Carpeta elementos recuperables](http://technet.microsoft.com/es-es/library/ee364755%28v=exchg.150%29.aspx(Office.15).aspx)</span><span class="sxs-lookup"><span data-stu-id="5428f-258">[Recoverable Items Folder](http://technet.microsoft.com/es-es/library/ee364755%28v=exchg.150%29.aspx(Office.15).aspx)</span></span>
    
- [<span data-ttu-id="5428f-259">ExchangeService.FindItems</span><span class="sxs-lookup"><span data-stu-id="5428f-259">ExchangeService.FindItems</span></span>](http://msdn.microsoft.com/es-es/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="5428f-260">Operaciones de búsqueda de la limitación de los parámetros de directiva que afectan a EWS</span><span class="sxs-lookup"><span data-stu-id="5428f-260">Throttling policy parameters that affect EWS search operations</span></span>](ews-throttling-in-exchange.md#bk_ThrottlingSearch)
    

